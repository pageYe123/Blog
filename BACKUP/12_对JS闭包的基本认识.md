# [对JS闭包的基本认识](https://github.com/yeshiqing/Blog/issues/12)


```
function fn() {
    let foo = '123'
    return function fn_inner() {
        console.log(foo)
    }
}
fn()(); // '123'
```

## 什么是闭包？

「函数」和「函数内部能访问到的变量」的总和，就是一个闭包。如上代码中，函数 fn_inner 和函数内部能访问到的变量 foo 组成一个闭包。

## 闭包的用途是什么？

- 保护函数的私有变量不受外部的干扰，形成不销毁的栈内存（一般来说，函数执行完后栈内存会被销毁），这些变量会存储在堆内存中。

- 把一些函数内的值保存下来。闭包可以实现方法和属性的私有化。隐藏局部变量，暴露操作函数。

```js
let createAdd = ()=>{
    let n = 0
    return ()=>{
        n += 1
        console.log(n)
    }
}

const add = createAdd()
add() // 1
add() // 2
```

## 闭包的缺点是什么？

闭包会保留其它的函数作用域，因此会比其他函数占用更多的内存。过度使用闭包会导致内存占用过多，所以要谨慎使用闭包。比如在 IE 中，闭包使用完了仍然回收不了闭包所引用的变量，这就会导致内存泄漏。  
**注意，闭包并不会造成内存泄露，真实原因是 JS 引擎的实现有问题。**

